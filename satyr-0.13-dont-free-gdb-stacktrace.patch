From 969aedadec7f1f693f53ddaf8dcb1f1d59d5ac72 Mon Sep 17 00:00:00 2001
From: Martin Milata <mmilata@redhat.com>
Date: Tue, 23 Sep 2014 18:22:27 +0200
Subject: [SATYR PATCH] Don't free gdb stacktrace if no crash thread found

Possibly related to rhbz#1145697.

Signed-off-by: Martin Milata <mmilata@redhat.com>
---
 lib/gdb_stacktrace.c | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/lib/gdb_stacktrace.c b/lib/gdb_stacktrace.c
index 8e73e21..3b2465a 100644
--- a/lib/gdb_stacktrace.c
+++ b/lib/gdb_stacktrace.c
@@ -558,10 +558,7 @@ sr_gdb_stacktrace_to_short_text(struct sr_gdb_stacktrace *stacktrace,
     crash_thread = sr_gdb_stacktrace_find_crash_thread(stacktrace);
 
     if (!crash_thread)
-    {
-        sr_gdb_stacktrace_free(stacktrace);
         return NULL;
-    }
 
     struct sr_gdb_thread *optimized_thread
         = sr_gdb_thread_get_optimized(crash_thread, stacktrace->libs,
-- 
1.9.3

